# Security Policy

## Reporting a Vulnerability

If you discover a security vulnerability in this repository, **please report it responsibly**. Do not open a public GitHub issue.

Instead, use [GitHub's private vulnerability reporting](https://github.com/Joe-Heffer/moltbot/security/advisories/new) to submit your report. This ensures the issue can be assessed and addressed before public disclosure.

When reporting, please include:

- A description of the vulnerability and its potential impact
- Steps to reproduce the issue
- Affected files or components (e.g. deployment scripts, systemd configuration, CI/CD workflows)
- Any suggested fixes, if applicable

You can expect an initial response within **7 days**. We will work with you to understand the issue and coordinate a fix and disclosure timeline.

## Scope

This repository contains deployment scripts, systemd service configuration, and CI/CD workflows for [OpenClaw](https://openclaw.ai). Security issues in scope include:

- **Deployment scripts** (`deploy/deploy.sh`, `deploy/setup-server.sh`, `deploy/uninstall.sh`) -- privilege escalation, command injection, insecure file permissions
- **Systemd service configuration** (`deploy/openclaw-gateway.service`) -- sandbox escapes, insufficient hardening
- **CI/CD workflows** (`.github/workflows/`) -- secret leakage, supply chain attacks, workflow injection
- **Sudoers configuration** generated by `setup-server.sh` -- overly broad permissions, privilege escalation paths
- **Environment template** (`deploy/openclaw.env.template`) -- accidental credential exposure

For security issues in the **core OpenClaw application**, please report them to the [openclaw/openclaw](https://github.com/openclaw/openclaw) repository instead.

## Security Measures

This repository implements the following security practices:

### Privilege Isolation

- The installer creates a dedicated, non-root `openclaw` system user with limited shell access
- The CI/CD `deploy` user has narrowly scoped sudo permissions (specific systemctl/journalctl commands only)
- Sudoers configuration is validated with `visudo -c` to prevent lockout

### Systemd Hardening

The service unit applies defense-in-depth restrictions:

- `NoNewPrivileges=yes` -- prevents privilege escalation
- `PrivateTmp=yes` -- isolates temporary files
- `ProtectSystem=strict` -- mounts the system read-only
- `ProtectHome=read-only` -- restricts home directory writes to explicit paths
- `ProtectKernelTunables=yes`, `ProtectKernelModules=yes`, `ProtectControlGroups=yes` -- kernel protection
- `RestrictNamespaces=yes`, `RestrictSUIDSGID=yes`, `LockPersonality=yes` -- additional sandboxing
- `ReadWritePaths` limited to openclaw config, data, and npm directories only

### Supply Chain Security

- All GitHub Actions are pinned to full commit SHAs, not mutable version tags
- Shell scripts are checked with [ShellCheck](https://www.shellcheck.net/) on every push and pull request
- GitHub Actions workflows are validated with [actionlint](https://github.com/rhysd/actionlint)

### Secret Management

- API keys and tokens are stored in a `.env` file with `600` permissions (owner read/write only)
- The `.env` file is excluded from version control via `.gitignore`
- CI/CD secrets (SSH keys, host addresses) are stored in GitHub Actions encrypted secrets

## Deployment Hardening Checklist

When deploying OpenClaw, follow these recommendations:

- [ ] **Never run as root.** The installer creates a dedicated `openclaw` user -- always run the service under this account.
- [ ] **Use pairing mode.** Keep `DM_POLICY=pairing` (default) to require approval before the bot responds to new contacts.
- [ ] **Use Tailscale for remote access.** Avoid exposing port 18789 directly to the internet. Use [Tailscale Serve/Funnel](https://docs.openclaw.ai/gateway/tailscale) instead.
- [ ] **Restrict firewall rules.** Only open ports that are strictly necessary.
- [ ] **Isolate the host.** Run OpenClaw on a dedicated VM or VPS that does not contain sensitive data or credentials for other services.
- [ ] **Review skills before installing.** Only install skills from sources you trust.
- [ ] **Keep the system updated.** Regularly apply OS security patches and update OpenClaw to the latest version.
- [ ] **Rotate API keys.** Periodically rotate your LLM provider API keys and any messaging platform tokens.
